# AutoBlue（オートブルー）

## 概要
AutoBlueは、色ブロックの検出、仮想ゲームパッド入力、仮想マウス入力などのサードパーティライブラリを使用した、通常のオートプレイスクリプトです。

[简体中文](README.zh-CN.md) | [English](README.md) | [日本語](README.jp.md)

## 使用の開始

このプロジェクトをローカル環境にダウンロードし、次のコマンドをプロジェクトフォルダで実行します。

```
pip install -r requirements.txt
```

これにより、必要なサードパーティライブラリがインストールされます。

最初に使用する前に、ローカルマシンの設定を行う必要があります。

まず、クライアントの体力バーの座標を取得する必要があります。[抓抓工具](https://wwuh.lanzout.com/iAItC115cv2d)をダウンロードします。
抓抓工具を開き、任意のモンスターを選択し、マウスをそのモンスターの体力バーの左端に合わせ、右に数ピクセルずらしてください。また、マウスをできるだけ垂直中央に位置するように調整してください。その後、Ctrl+Alt+1を押します。抓抓工具には、この位置の座標が表示されます。

同様の方法で、自分の体力バーの座標も取得してください。ただし、これは最左端ではなく、体力バーの80％の位置くらいである必要があります（弓使いでない場合、体力バーの座標を設定する必要はありません）。

config.iniファイルを開きます。デフォルトの設定は次のとおりです。

```
[General]
# 敵の現在のターゲットの色
target_color = 247, 1, 0
# 体力バーの背景板の色
hp_color = 51, 51, 51
x_original_value = 821
y_original_value = 61
hp_x = 831
hp_y = 1045
# 色の許容範囲
color_tolerance = 10
# 戦闘のタイムアウト時間
timeout = 30
# バフによる体力バーの移動ピクセル数
target_window_pianyi_original = 7
```

さきほど取得した座標（例：821、61）をx_original_valueおよびy_original_valueに変更します。

デフォルトでは、3番目のボタンがアクティブスキル、2番目のボ

タンが戦闘イメージ、右クリックが生命回復手段として設定されています。コードを変更したくない場合は、ゲーム内でスキルの位置を変更してください。

これでスクリプトを実行できます。

```python
py main.py
```

## スクリプトのロジック

- 動作フローは次のとおりです：起動-視点をリセット-目標の検索を回転-目標をロック-スキルループに入る-目標が死亡-再び目標の検索
- target_colorが指定の色に近い場合、現在の目標がロックされていると判断し、戦闘ループに入ります。それ以外の場合は、敵の検索ループに入ります。
- hp_colorがプレイヤーの体力バーの背景色と一致する場合、強制的に体力回復ループに入ります。
- ロックされた目標が失われる可能性があるため、指定された時間が経過すると強制的に新しい目標を検索します。
- 旋回検索は、視点が非常に奇妙な場所にあるために多くのループが回されても敵を見つけることができない場合があるため、指定された時間が経過すると視点をリセットします。
- 体力が低下すると自動的に体力回復ループに入ります（弓使いの場合のみ）。
- 仮想ゲームパッド入力にはvgamepadライブラリ、マウスホイール入力にはpyautoguiライブラリを使用します。
- ウィンドウを16：9の比率でスケーリングするだけで、ウィンドウをどこに配置しても、最大30秒の時間が経過すると体力バーの位置が再配置されます。

## 注意事項

- デフォルトのループでは、マウスホイールを下方向にスクロールします。万代はゲーム内でコントローラを使用したターゲット切り替えを許可していないためです。
- "任意のコントローラが接続されている"状態でスクリプトを開始すると、スクリプトが機能しなくなります。ゲームでは1つのコントローラのみが許可されるためです。

## カスタム設定

（後で追加予定）

## 推奨オート

プレイ場所

### レベル1-5：最初のフィールドマップで適当にオートプレイ
実際、メインクエストに少し付いていくだけでレベル5になり、その後は自由探索に入れます。

### レベル3-14：自由探索の入り口
無敵の場所で、ダメージを受けません
![img](https://raw.githubusercontent.com/lingyun67/AutoBlue/main/img/3-14.png)

### レベル11-21：ルーツホーム
ここに石を見つけると、傷つけずに狼を攻撃できますが、ゴブリンキャンプよりも効率は低いでしょう。
![img](https://raw.githubusercontent.com/lingyun67/AutoBlue/main/img/11-21.png)

### レベル14-22：ゴブリンキャンプ
ダメージを回避する方法はありませんが、非常に多くの人々がいるため、実際には問題ありません。ただし、悪名のエリートがスポーンする可能性があります。レベリングのために来たのであれば、この紫色のヤツが視界を遮るかもしれませんが、彼が死ねば影響はありません。
![img](https://raw.githubusercontent.com/lingyun67/AutoBlue/main/img/14-22.png)

## 複雑な機能の実装

get_target_health_bar_coordinatesメソッド：

フルスクリーンモードの1080pで、821,61の座標に赤色のピクセルがある場合、その座標のxy軸の変数名はx_original_valueおよびy_original_valueです。

get_target_health_bar_coordinatesメソッドを呼び出すと、既存のget_window_coordinatesメソッドが呼び出されます。get_window_coordinatesはウィンドウの4つのデータ（window_left、window_top、window_width、window_height）を返します。これらのデータは、ウィンドウの左上隅のx座標、ウィンドウの左上隅のy座標、ウィンドウの幅、およびウィンドウの高さを表します。

get_target_health_bar_coordinatesメソッドでは、これらの4つのデータを取得した後、ウィンドウの幅をスクリーンの幅で割り、ウィンドウの高さをスクリーンの高さで割ることで、縮小比率を取得します。

次に、x_original_valueおよびy_original_valueの座標変数をこの比率で乗算し、

ウィンドウ内の正確な座標を計算します。

最後に、ウィンドウ内の座標を返します。
